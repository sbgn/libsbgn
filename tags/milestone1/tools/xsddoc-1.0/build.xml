<?xml version="1.0" encoding="UTF-8"?>
<!--
This file is part of the xframe software package
hosted at http://xframe.sourceforge.net

Copyright (c) 2003 Kurt Riede.

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
-->
<project name="xframe-xsddoc-build" default="all">
  <!--
    load build properties
  -->
  <property file="build.properties"/>
  <property environment="env"/>
  <!--
    target all
  -->
  <target name="all" depends="deploy"/>
  <!--
    target init
  -->
  <target name="init" >
  	<delete dir="classes"/>
    <mkdir dir="classes"/>
    <mkdir dir="target/dist"/>
    <mkdir dir="doc"/>
  </target>
  <!--
    target increaseBuildNumber
  -->
  <target name="increaseBuildNumber">
    <propertyfile file="build.number" comment="Global build number. Please do not edit this file">
      <entry key="build.number" type="int" default="0000" operation="+" pattern="0000"/>
    </propertyfile>
  </target>
  <!--
    target compile
  -->
  <target name="compile" depends="init">
    <javac srcdir="src" destdir="classes" compiler="modern" deprecation="off" nowarn="on" debug="on" debuglevel="lines" failonerror="false">
      <classpath>
        <fileset dir="lib/">
          <include name="**/*.jar"/>
        </fileset>
      </classpath>
    </javac>
    <copy todir="classes">
      <fileset dir="src" includes="**/*.xsl"/>
      <fileset dir="src" includes="**/*.css"/>
    </copy>
  </target>
  <!--
    target jar
  -->
  <target name="jar" depends="compile">
    <property file="build.number"/>
    <tstamp>
      <format property="TODAY" pattern="yyy-MM-dd" locale="en"/>
    </tstamp>
    <jar destfile="lib/xsddoc.jar" basedir="classes">
      <manifest>
        <attribute name="Manifest-Version" value="1.0"/>
        <attribute name="Created-By" value="${project.name} - ${project.author}"/>
        <attribute name="Specification-Title" value="${project.name} - ${subproject.name}"/>
        <attribute name="Specification-Vendor" value="${project.name} - ${project.author}"/>
        <attribute name="Implementation-Version" value="${build.number} ${TODAY}"/>
        <attribute name="Implementation-Vendor" value="${implementation-vendor}"/>
        <attribute name="Implementation-Vendor-Id" value="${implementation-vendor}"/>
      </manifest>
    </jar>
  </target>
  <!--
    target dist
  -->
  <target name="deploy" depends="dist">
  	<copy file="lib/xsddoc.jar" tofile="${env.ANT_HOME}/lib/xsddoc.jar"></copy>
  </target>
  <!--
    target dist
  -->
  <target name="dist" depends="increaseBuildNumber, jar, javadoc">
    <property file="build.version"/>
    <property name="prefix" value="${subproject.name}-${build.version}" />
    <zip destfile="target/dist/${prefix}.zip">
      <zipfileset dir="bin" prefix="${prefix}/bin"/>
      <zipfileset dir="doc" prefix="${prefix}/doc"/>
      <zipfileset dir="legal" prefix="${prefix}/legal"/>
      <zipfileset dir="lib" prefix="${prefix}/lib"/>
      <zipfileset dir="samples" prefix="${prefix}/samples">
        <include name="**/*.xsd"/>
        <include name="**/*.dtd"/>
        <exclude name="**/html"/>
        <exclude name="private/**/*"/>
      </zipfileset>
      <zipfileset dir="src" prefix="${prefix}/src"/>
      <zipfileset dir="." prefix="${prefix}">
      	<include name="*"/>
      </zipfileset>
    </zip>
    <delete file="target/dist/${prefix}.tar-gz"/>
    <tar longfile="gnu" destfile="target/dist/${prefix}.tar">
      <tarfileset dir="bin" mode="755" username="root" group="system" prefix="${prefix}/bin"/>
      <tarfileset dir="doc" mode="755" username="root" group="system" prefix="${prefix}/doc"/>
      <tarfileset dir="legal" mode="755" username="root" group="system" prefix="${prefix}/legal"/>
      <tarfileset dir="lib" mode="755" username="root" group="system" prefix="${prefix}/lib"/>
      <tarfileset dir="samples" mode="755" username="root" group="system" prefix="${prefix}/samples">
        <include name="**/*.xsd"/>
        <include name="**/*.dtd"/>
        <exclude name="**/html"/>
        <exclude name="private/**/*"/>
      </tarfileset>
      <tarfileset dir="src" mode="755" username="root" group="system" prefix="${prefix}/src"/>
      <tarfileset dir="." mode="755" username="root" group="system" prefix="${prefix}">
      	<include name="*"/>
      </tarfileset>
    </tar>
    <gzip src="target/dist/${prefix}.tar" zipfile="target/dist/${prefix}.tar.gz"/>
    <delete file="target/dist/${prefix}.tar"/>
  </target>
  <!--
    target javadoc
  -->
  <target name="javadoc">
  	<mkdir dir="doc/api"/>
    <javadoc sourcepath="src" destdir="doc/api"
             packagenames="net.sf.xframe.*" access="protected" use="true"
             splitindex="false" author="true" version="true" notree="false"
             nonavbar="false" noindex="false"
             nodeprecatedlist="false" nodeprecated="false">
      <doctitle><![CDATA[xframe - xsddoc API Documentation]]></doctitle>
      <header><![CDATA[header]]></header>
      <bottom><![CDATA[<font size="-1">Submit a
      <a target="_blank" href="http://sourceforge.net/tracker/?atid=454391&amp;group_id=48863&amp;func=browse">bug</a> or a
      <a target="_blank" href="http://sourceforge.net/tracker/?atid=454394&amp;group_id=48863&amp;func=browse">feature</a>.<br>Created by
      <a target="_blank" href="http://xframe.sourceforge.net/xsddoc/index..html">xsddoc</a>, a sub project of
      <a target="_blank" href="http://xframe.sourceforge.net">xframe</a>, hosted at
      <a target="_blank" href="http://www.sourceforge.net">http://www.sourceforge.net</a>.</font>]]></bottom>
      <classpath>
        <fileset dir="lib/">
          <include name="**/*.jar"/>
        </fileset>
      </classpath>
    </javadoc>
  </target>
</project>
